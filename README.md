# Дипломная работа «Облачное хранилище»

Стек: Spring Boot, Spring Security, Spring Data JPA, PostgreSQL, Liqquibase, JUnit, Mockito, Testcontainers, Maven, Docker.
## Описание
Проект предоставляет собой REST-сервис для загрузки, скачивания, переименования, удаления и вывода списка загруженных файлов пользователя. Все запросы к сервису авторизованы. Веб приложение (FRONT) подключается к данному сервису и использует его функционал для авторизации и работы с файлами. Для хранения информации о пользователях сервиса (логинов для авторизации) и файлов задействована база данных PostgreSQl. Заполнение базы данных осуществлено при помощи миграции.

## Запуск FRONT приложения
Репозиторий FRONT приложения доступен по адресу [cloud-storage-frontend](https://github.com/netology-code/jd-homeworks/tree/master/diploma/netology-diplom-frontend). 
Для запуска FRONT приложения необходимо:
1. Скачать репозиторий и распаковать его в локальную папку
2. Установить nodejs (версия не ниже 19.7.0)
3. Задать url для вызова данного backend-сервиса: обозначить переменную `VUE_APP_BASE_URL` в файле `.env` следующим образом - `http://localhost:8090`
5. Перейти в папку FRONT приложения в командной строке и выполнить команды `npm install`, затем `npm run serve`
Таким образом, FRONT будет доступен по адресу http://localhost:8080/ и отправлять запросы REST-сервису на адрес http://localhost:8090/

## Запуск REST приложения
Для запуска приложения используются команды Docker
1. Скачать или склонировать репозиторий приложения в программу IntelliJ IDEA
2. Заменить имя пользователя и пароль к базе данных в файлах `application.properties` и `docker-compose.yml`
3. Упаковать проект в Maven
4. В терминале приложения командой `docker build -t app:latest .` создать образ приложения
5. Упаковать образ в контейнер командой `docker-compose build`
6. Запустить контейнер командой `docker-compose up`
7. Для остановки приложения нажать Ctrl+C

## Пример использования
В приложении можно авторизоваться используя данные: имя пользователя - `user1@gmail.com`, пароль - `user1`. После этого можно загружать любые файлы размером до 100Мб.

## Взаимодействие приложений
FRONT приложение отправляет credentials в теле запроса на эндпоинт `/login` BACKEND приложения. В случае успешной авторизации пользователя, в качестве ответа BACKEND возвращает json-объект с полем `auth-token` и значением токена. Все дальейшие запросы с FRONTEND, кроме метода `/login`, отправляются с этим header. При выходе из приложения задействуется метод BACKEND `/logout`, который удаляет токен из списка действиельных. Последующие запросы с этим токеном не пройдут авторизацию.
